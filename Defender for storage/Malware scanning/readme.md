# Test malware scanning

Legacy per-transcation mode <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/a5307e41-bf0c-4f53-a4ba-397286e94f75)

#### 1. Enable per-account mode and turn on on-upload malware scanning
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/5fd85903-bf35-4cc4-ad9e-36a8d3c1dc8a) <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/1019cebf-8898-4e94-a140-3ba6cb8db630) <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/70fa06de-3e81-4d76-b3ce-d3931a9ff179)

#### 2. [Create a container](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-quickstart-blobs-portal#create-a-container) <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/42577706-895a-41ca-b0ce-588091444f3b) <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/e643f48d-57d8-44d3-a7a3-0a8e8efe799e) <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/fe02425f-6160-4db6-9b4c-4bd2657c4305)

#### 3. [Upload a block blob](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-quickstart-blobs-portal#upload-a-block-blob) <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/5a213855-e25c-41ca-a1b9-474da3514d4d) <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/36a2ff9c-b595-4353-adfb-bcf8e401c3c1)

#### 4. [Testing Malware Scanning](https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-storage-test#testing-malware-scanning) <br>
Click the file uploaded, two new tags are found: <br>
`Malware Scanning scan result` and `Malware Scanning scan time` <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/7bc49277-197e-4c7f-8c38-2cedc430a6d9) <br>
![image](https://github.com/guguji666666/GJS-MDC-Tips/assets/96930989/6faf9d4f-07da-4f62-9635-10275abd07c8)

[Permissions and authorization](https://learn.microsoft.com/en-us/azure/storage/blobs/storage-manage-find-blobs?tabs=azure-portal#permissions-and-authorization)
|Blob index tag operations|  Azure RBAC action|
|--|--|
| Set Blob Tags | Microsoft.Storage/storageAccounts/blobServices/containers/blobs/tags/write |
| Get Blob Tags | Microsoft.Storage/storageAccounts/blobServices/containers/blobs/tags/read |
| Find Blobs by Tags | Microsoft.Storage/storageAccounts/blobServices/containers/blobs/filter/action |
